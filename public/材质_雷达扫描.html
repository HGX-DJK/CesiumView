<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <title>材质_雷达扫描</title>
    <link href="./cesium/Widgets/widgets.css" rel="stylesheet" />
    <script src="./cesium/Cesium.js"></script>
    <style>
        html,
        body,
        #cesiumContainer {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        #canvas-a {
            top: 10px;
            display: none;
        }


    </style>

</head>

<body>
    <div id="cesiumContainer"></div>
    <canvas id="canvas-a" class="canvas" width="300" height="300"></canvas>
    <script>
//注册Cesium Ion令牌
Cesium.Ion.defaultAccessToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI2YjA2MDlkOC02YjU2LTRhM2QtYmI3Zi1lMDI3ZmQ0MTFiNWQiLCJpZCI6Mzk0OTMsImlhdCI6MTcyNjMwMDUxOX0.H9gvu2kRlbbfWS27EMXG1daljQfhOMSNQU__OoWVigk";
        let viewer = new Cesium.Viewer('cesiumContainer', {
            imageryProvider: new Cesium.ArcGisMapServerImageryProvider({
                url: "https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",
            }),
        });
 
        //设置初始位置
        viewer.camera.setView({
            destination: Cesium.Cartesian3.fromDegrees(110.20, 34.55, 3000000)
        });

        //开启深度检测
        viewer.scene.globe.depthTestAgainstTerrain = true;
        startScann();
        //开始扫描
        function startScann(){
            viewer.entities.add({
                name: 'Rotating rectangle with rotating texture coordinate',
                rectangle: {
                    coordinates: new Cesium.CallbackProperty(function(){
                        return Cesium.Rectangle.fromDegrees(-75.0, 30.0, -70.0, 35.0)
                    },false),
                    material: new Cesium.ImageMaterialProperty({
                        image: new Cesium.CallbackProperty(drawCanvas, false),
                        transparent: true
                    }),
                    rotation: new Cesium.CallbackProperty(getRotationValue, false),
                    stRotation: new Cesium.CallbackProperty(getRotationValue, false)
                }
            });
            console.log(viewer.entities);
            // viewer.zoomTo(viewer.entities);
        }

        let rotation = Cesium.Math.toRadians(30);

        function getRotationValue() {
            rotation -= 0.02;
            return rotation;
        }

        function drawCanvas() {
            let canvas = document.getElementById("canvas-a");
            let context = canvas.getContext('2d');
			let grd = context.createLinearGradient(175, 100, canvas.width, 150);
			grd.addColorStop(0, "rgba(0,255,0,0)");
			grd.addColorStop(1, "rgba(0,255,0,1)");
			context.fillStyle = grd;
			context.beginPath();
			context.moveTo(150, 150);
			context.arc(150, 150, 140, -90 / 180 * Math.PI, 0 / 180 * Math.PI);//context.arc(x,y,r,sAngle,eAngle,counterclockwise);
			context.fill();
            
            return canvas;
        }



    </script>
</body>

</html>